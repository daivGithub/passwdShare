{"remainingRequest":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/src/views/activiti/historic-detail/historicDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/src/views/activiti/historic-detail/historicDetail.vue","mtime":1577168504901},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEhpZ2hsaWdodEltZywgaGlzdG9yaWNGbG93IH0gZnJvbSAiQC9hcGkvYWN0aXZpdGkiOwppbXBvcnQgdXRpbCBmcm9tICJAL2xpYnMvdXRpbCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiaGlzdG9yaWNfZGV0YWlsIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdHlwZTogMCwKICAgICAgbG9hZGluZzogZmFsc2UsIC8vIOihqOWNleWKoOi9veeKtuaAgQogICAgICBsb2FkaW5nSW1nOiBmYWxzZSwKICAgICAgY29sdW1uczogWwogICAgICAgIC8vIOihqOWktAogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJzZWxlY3Rpb24iLAogICAgICAgICAgd2lkdGg6IDYwLAogICAgICAgICAgYWxpZ246ICJjZW50ZXIiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0eXBlOiAiaW5kZXgiLAogICAgICAgICAgd2lkdGg6IDYwLAogICAgICAgICAgYWxpZ246ICJjZW50ZXIiCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIuS7u+WKoeWQjeensCIsCiAgICAgICAgICBrZXk6ICJuYW1lIiwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIuWkhOeQhuS6uiIsCiAgICAgICAgICBrZXk6ICJhc3NpZ25lZXMiLAogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgICBtaW5XaWR0aDogMTAwLAogICAgICAgICAgcmVuZGVyOiAoaCwgcGFyYW1zKSA9PiB7CiAgICAgICAgICAgIHJldHVybiBoKAogICAgICAgICAgICAgICJkaXYiLAogICAgICAgICAgICAgIHBhcmFtcy5yb3cuYXNzaWduZWVzLm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkgewogICAgICAgICAgICAgICAgaWYgKGl0ZW0uaXNFeGVjdXRvcikgewogICAgICAgICAgICAgICAgICByZXR1cm4gaCgic3BhbiIsIFsKICAgICAgICAgICAgICAgICAgICBoKCJCYWRnZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtYXJnaW4tcmlnaHQiOiAiOHB4IgogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogInN1Y2Nlc3MiLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBpdGVtLnVzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICByZXR1cm4gaCgic3BhbiIsIFsKICAgICAgICAgICAgICAgICAgICBoKCJCYWRnZSIsIHsKICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJtYXJnaW4tcmlnaHQiOiAiOHB4IgogICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogImRlZmF1bHQiLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBpdGVtLnVzZXJuYW1lCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAi5a6h5om55pON5L2cIiwKICAgICAgICAgIGtleTogImRlbGV0ZVJlYXNvbiIsCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICLlrqHmibnmhI/op4EiLAogICAgICAgICAga2V5OiAiY29tbWVudCIsCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICLogJfml7YiLAogICAgICAgICAga2V5OiAiZHVyYXRpb24iLAogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgICByZW5kZXI6IChoLCBwYXJhbXMpID0+IHsKICAgICAgICAgICAgcmV0dXJuIGgoImRpdiIsIHV0aWwubWlsbHNUb1RpbWUocGFyYW1zLnJvdy5kdXJhdGlvbikpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgdGl0bGU6ICLliJvlu7rml7bpl7QiLAogICAgICAgICAga2V5OiAiY3JlYXRlVGltZSIsCiAgICAgICAgICB3aWR0aDogMTcwLAogICAgICAgICAgc29ydFR5cGU6ICJhc2MiLAogICAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRpdGxlOiAi5a6M5oiQ5pe26Ze0IiwKICAgICAgICAgIGtleTogImVuZFRpbWUiLAogICAgICAgICAgd2lkdGg6IDE3MCwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogIueKtuaAgSIsCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgICByZW5kZXI6IChoLCBwYXJhbXMpID0+IHsKICAgICAgICAgICAgbGV0IHRleHQgPSAiIiwKICAgICAgICAgICAgICBjb2xvciA9ICIiOwogICAgICAgICAgICBpZiAocGFyYW1zLnJvdy5lbmRUaW1lKSB7CiAgICAgICAgICAgICAgY29sb3IgPSAiYmx1ZSI7CiAgICAgICAgICAgICAgdGV4dCA9ICLlt7Llip7nkIYiOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbG9yID0gImRlZmF1bHQiOwogICAgICAgICAgICAgIHRleHQgPSAi5b6F5aSE55CGIjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gaCgiZGl2IiwgWwogICAgICAgICAgICAgIGgoCiAgICAgICAgICAgICAgICAiVGFnIiwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRleHQKICAgICAgICAgICAgICApCiAgICAgICAgICAgIF0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgXSwKICAgICAgZGF0YTogW10sCiAgICAgIGlkOiAiIiwKICAgICAgaW1nVXJsOiAiIiwKICAgICAgYmFja1JvdXRlOiAiIgogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXQoKSB7CiAgICAgIHRoaXMudHlwZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnR5cGU7CiAgICAgIHRoaXMuYmFja1JvdXRlID0gdGhpcy4kcm91dGUucXVlcnkuYmFja1JvdXRlOwogICAgICB0aGlzLmlkID0gdGhpcy4kcm91dGUucXVlcnkuaWQ7CiAgICAgIHRoaXMuaW1nVXJsID0KICAgICAgICBnZXRIaWdobGlnaHRJbWcgKwogICAgICAgIHRoaXMuaWQgKwogICAgICAgICI/YWNjZXNzVG9rZW49IiArCiAgICAgICAgdGhpcy5nZXRTdG9yZSgiYWNjZXNzVG9rZW4iKSArCiAgICAgICAgIiZ0aW1lPSIgKwogICAgICAgIG5ldyBEYXRlKCk7CiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsKICAgIH0sCiAgICBnZXREYXRhTGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgaGlzdG9yaWNGbG93KHRoaXMuaWQpLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXMuZGF0YSA9IHJlcy5yZXN1bHQ7CiAgICAgICAgICBpZiAoIXJlcy5yZXN1bHQgfHwgcmVzLnJlc3VsdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICB0aGlzLiRNb2RhbC5pbmZvKHsKICAgICAgICAgICAgICB0aXRsZTogIuacquaJvuWIsOivpeiusOW9leWuoeaJueWOhuWPsuaVsOaNriIsCiAgICAgICAgICAgICAgY29udGVudDogIuWOhuWPsuaVsOaNruWPr+iDveW3suiiq+WIoOmZpCIKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDlhbPpl63lvZPliY3pobXpnaIKICAgIGNsb3NlQ3VycmVudFBhZ2UoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgicmVtb3ZlVGFnIiwgImhpc3RvcmljX2RldGFpbCIpOwogICAgICBsb2NhbFN0b3JhZ2UucGFnZU9wZW5lZExpc3QgPSBKU09OLnN0cmluZ2lmeSgKICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5hcHAucGFnZU9wZW5lZExpc3QKICAgICAgKTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6IHRoaXMuYmFja1JvdXRlCiAgICAgIH0pOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdCgpOwogIH0sCiAgd2F0Y2g6IHsKICAgIC8vIOebkeWQrOi3r+eUseWPmOWMlgogICAgJHJvdXRlKHRvLCBmcm9tKSB7CiAgICAgIGlmICh0by5uYW1lID09ICJoaXN0b3JpY19kZXRhaWwiKSB7CiAgICAgICAgdGhpcy5pbml0KCk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["historicDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"historicDetail.vue","sourceRoot":"src/views/activiti/historic-detail","sourcesContent":["<style lang=\"less\">\n@import \"./historicDetail.less\";\n</style>\n<template>\n  <div class=\"search\">\n    <Card style=\"margin-bottom:10px;\">\n      <p slot=\"title\">\n        <span>流程审批进度历史</span>\n      </p>\n      <Row style=\"position:relative\">\n        <Table :loading=\"loading\" border :columns=\"columns\" :data=\"data\" ref=\"table\"></Table>\n        <Spin size=\"large\" fix v-if=\"loading\"></Spin>\n      </Row>\n    </Card>\n    <Card>\n      <p slot=\"title\">\n        <span>实时流程图</span>\n      </p>\n      <Row style=\"position:relative\">\n        <img :src=\"imgUrl\" />\n        <Spin size=\"large\" fix v-if=\"loadingImg\"></Spin>\n      </Row>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { getHighlightImg, historicFlow } from \"@/api/activiti\";\nimport util from \"@/libs/util\";\nexport default {\n  name: \"historic_detail\",\n  data() {\n    return {\n      type: 0,\n      loading: false, // 表单加载状态\n      loadingImg: false,\n      columns: [\n        // 表头\n        {\n          type: \"selection\",\n          width: 60,\n          align: \"center\"\n        },\n        {\n          type: \"index\",\n          width: 60,\n          align: \"center\"\n        },\n        {\n          title: \"任务名称\",\n          key: \"name\",\n          sortable: true\n        },\n        {\n          title: \"处理人\",\n          key: \"assignees\",\n          align: \"center\",\n          sortable: true,\n          minWidth: 100,\n          render: (h, params) => {\n            return h(\n              \"div\",\n              params.row.assignees.map(function(item, index) {\n                if (item.isExecutor) {\n                  return h(\"span\", [\n                    h(\"Badge\", {\n                      style: {\n                        \"margin-right\": \"8px\"\n                      },\n                      props: {\n                        status: \"success\",\n                        text: item.username\n                      }\n                    })\n                  ]);\n                } else {\n                  return h(\"span\", [\n                    h(\"Badge\", {\n                      style: {\n                        \"margin-right\": \"8px\"\n                      },\n                      props: {\n                        status: \"default\",\n                        text: item.username\n                      }\n                    })\n                  ]);\n                }\n              })\n            );\n          }\n        },\n        {\n          title: \"审批操作\",\n          key: \"deleteReason\",\n          align: \"center\",\n          sortable: true\n        },\n        {\n          title: \"审批意见\",\n          key: \"comment\",\n          align: \"center\",\n          sortable: true\n        },\n        {\n          title: \"耗时\",\n          key: \"duration\",\n          align: \"center\",\n          sortable: true,\n          render: (h, params) => {\n            return h(\"div\", util.millsToTime(params.row.duration));\n          }\n        },\n        {\n          title: \"创建时间\",\n          key: \"createTime\",\n          width: 170,\n          sortType: \"asc\",\n          sortable: true\n        },\n        {\n          title: \"完成时间\",\n          key: \"endTime\",\n          width: 170,\n          sortable: true\n        },\n        {\n          title: \"状态\",\n          align: \"center\",\n          render: (h, params) => {\n            let text = \"\",\n              color = \"\";\n            if (params.row.endTime) {\n              color = \"blue\";\n              text = \"已办理\";\n            } else {\n              color = \"default\";\n              text = \"待处理\";\n            }\n            return h(\"div\", [\n              h(\n                \"Tag\",\n                {\n                  props: {\n                    color: color\n                  }\n                },\n                text\n              )\n            ]);\n          }\n        }\n      ],\n      data: [],\n      id: \"\",\n      imgUrl: \"\",\n      backRoute: \"\"\n    };\n  },\n  methods: {\n    init() {\n      this.type = this.$route.query.type;\n      this.backRoute = this.$route.query.backRoute;\n      this.id = this.$route.query.id;\n      this.imgUrl =\n        getHighlightImg +\n        this.id +\n        \"?accessToken=\" +\n        this.getStore(\"accessToken\") +\n        \"&time=\" +\n        new Date();\n      this.getDataList();\n    },\n    getDataList() {\n      this.loading = true;\n      historicFlow(this.id).then(res => {\n        this.loading = false;\n        if (res.success) {\n          this.data = res.result;\n          if (!res.result || res.result.length == 0) {\n            this.$Modal.info({\n              title: \"未找到该记录审批历史数据\",\n              content: \"历史数据可能已被删除\"\n            });\n          }\n        }\n      });\n    },\n    // 关闭当前页面\n    closeCurrentPage() {\n      this.$store.commit(\"removeTag\", \"historic_detail\");\n      localStorage.pageOpenedList = JSON.stringify(\n        this.$store.state.app.pageOpenedList\n      );\n      this.$router.push({\n        name: this.backRoute\n      });\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  watch: {\n    // 监听路由变化\n    $route(to, from) {\n      if (to.name == \"historic_detail\") {\n        this.init();\n      }\n    }\n  }\n};\n</script>"]}]}