{"remainingRequest":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/src/views/activiti/historic-detail/historicDetail.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/src/views/activiti/historic-detail/historicDetail.vue","mtime":1577168504901},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/daiv/files/GitProjects/passwdShare/passwd-share-front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBpbXBvcnQgIi4vaGlzdG9yaWNEZXRhaWwubGVzcyI7Cg=="},{"version":3,"sources":["historicDetail.vue"],"names":[],"mappings":";AACA","file":"historicDetail.vue","sourceRoot":"src/views/activiti/historic-detail","sourcesContent":["<style lang=\"less\">\n@import \"./historicDetail.less\";\n</style>\n<template>\n  <div class=\"search\">\n    <Card style=\"margin-bottom:10px;\">\n      <p slot=\"title\">\n        <span>流程审批进度历史</span>\n      </p>\n      <Row style=\"position:relative\">\n        <Table :loading=\"loading\" border :columns=\"columns\" :data=\"data\" ref=\"table\"></Table>\n        <Spin size=\"large\" fix v-if=\"loading\"></Spin>\n      </Row>\n    </Card>\n    <Card>\n      <p slot=\"title\">\n        <span>实时流程图</span>\n      </p>\n      <Row style=\"position:relative\">\n        <img :src=\"imgUrl\" />\n        <Spin size=\"large\" fix v-if=\"loadingImg\"></Spin>\n      </Row>\n    </Card>\n  </div>\n</template>\n\n<script>\nimport { getHighlightImg, historicFlow } from \"@/api/activiti\";\nimport util from \"@/libs/util\";\nexport default {\n  name: \"historic_detail\",\n  data() {\n    return {\n      type: 0,\n      loading: false, // 表单加载状态\n      loadingImg: false,\n      columns: [\n        // 表头\n        {\n          type: \"selection\",\n          width: 60,\n          align: \"center\"\n        },\n        {\n          type: \"index\",\n          width: 60,\n          align: \"center\"\n        },\n        {\n          title: \"任务名称\",\n          key: \"name\",\n          sortable: true\n        },\n        {\n          title: \"处理人\",\n          key: \"assignees\",\n          align: \"center\",\n          sortable: true,\n          minWidth: 100,\n          render: (h, params) => {\n            return h(\n              \"div\",\n              params.row.assignees.map(function(item, index) {\n                if (item.isExecutor) {\n                  return h(\"span\", [\n                    h(\"Badge\", {\n                      style: {\n                        \"margin-right\": \"8px\"\n                      },\n                      props: {\n                        status: \"success\",\n                        text: item.username\n                      }\n                    })\n                  ]);\n                } else {\n                  return h(\"span\", [\n                    h(\"Badge\", {\n                      style: {\n                        \"margin-right\": \"8px\"\n                      },\n                      props: {\n                        status: \"default\",\n                        text: item.username\n                      }\n                    })\n                  ]);\n                }\n              })\n            );\n          }\n        },\n        {\n          title: \"审批操作\",\n          key: \"deleteReason\",\n          align: \"center\",\n          sortable: true\n        },\n        {\n          title: \"审批意见\",\n          key: \"comment\",\n          align: \"center\",\n          sortable: true\n        },\n        {\n          title: \"耗时\",\n          key: \"duration\",\n          align: \"center\",\n          sortable: true,\n          render: (h, params) => {\n            return h(\"div\", util.millsToTime(params.row.duration));\n          }\n        },\n        {\n          title: \"创建时间\",\n          key: \"createTime\",\n          width: 170,\n          sortType: \"asc\",\n          sortable: true\n        },\n        {\n          title: \"完成时间\",\n          key: \"endTime\",\n          width: 170,\n          sortable: true\n        },\n        {\n          title: \"状态\",\n          align: \"center\",\n          render: (h, params) => {\n            let text = \"\",\n              color = \"\";\n            if (params.row.endTime) {\n              color = \"blue\";\n              text = \"已办理\";\n            } else {\n              color = \"default\";\n              text = \"待处理\";\n            }\n            return h(\"div\", [\n              h(\n                \"Tag\",\n                {\n                  props: {\n                    color: color\n                  }\n                },\n                text\n              )\n            ]);\n          }\n        }\n      ],\n      data: [],\n      id: \"\",\n      imgUrl: \"\",\n      backRoute: \"\"\n    };\n  },\n  methods: {\n    init() {\n      this.type = this.$route.query.type;\n      this.backRoute = this.$route.query.backRoute;\n      this.id = this.$route.query.id;\n      this.imgUrl =\n        getHighlightImg +\n        this.id +\n        \"?accessToken=\" +\n        this.getStore(\"accessToken\") +\n        \"&time=\" +\n        new Date();\n      this.getDataList();\n    },\n    getDataList() {\n      this.loading = true;\n      historicFlow(this.id).then(res => {\n        this.loading = false;\n        if (res.success) {\n          this.data = res.result;\n          if (!res.result || res.result.length == 0) {\n            this.$Modal.info({\n              title: \"未找到该记录审批历史数据\",\n              content: \"历史数据可能已被删除\"\n            });\n          }\n        }\n      });\n    },\n    // 关闭当前页面\n    closeCurrentPage() {\n      this.$store.commit(\"removeTag\", \"historic_detail\");\n      localStorage.pageOpenedList = JSON.stringify(\n        this.$store.state.app.pageOpenedList\n      );\n      this.$router.push({\n        name: this.backRoute\n      });\n    }\n  },\n  mounted() {\n    this.init();\n  },\n  watch: {\n    // 监听路由变化\n    $route(to, from) {\n      if (to.name == \"historic_detail\") {\n        this.init();\n      }\n    }\n  }\n};\n</script>"]}]}